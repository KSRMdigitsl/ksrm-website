<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SIP Calculator — KSRM Digital</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9718922267093672" crossorigin="anonymous"></script>

  <!-- Chart.js for growth chart -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --ink:#0f172a; --muted:#64748b; --line:#e5e7eb;
      --chip:#eef2ff; --chip-on:#3b82f6; --chip-on-ink:#fff;
      --radius:14px; --shadow:0 10px 22px rgba(2,8,23,.05);
    }
    html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    .wrap{max-width:1200px;margin:0 auto;padding:16px 20px 48px;position:relative}

    .chips{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:16px 0}
    .chip{border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 14px;font-weight:600}
    .chip.is-on{background:var(--chip-on);color:var(--chip-on-ink);border-color:var(--chip-on)}
    h1{font-weight:800;font-size:clamp(26px,3.4vw,36px);margin:10px 0 6px}
    .lead{color:var(--muted);margin:0 0 18px}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--line);font-weight:700}
    .card .bd{padding:16px}

    .two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:720px){.two{grid-template-columns:1fr}}

    .lab{display:block;font-weight:600;margin:10px 0 6px}
    input[type="number"],select{
      width:100%;padding:12px;border:1px solid var(--line);border-radius:10px;background:#fff;font-weight:600
    }

    .stat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media (max-width:840px){.stat-grid{grid-template-columns:1fr}}
    .stat{background:#f8fafc;border:1px solid var(--line);border-radius:12px;padding:14px}
    .stat .k{color:var(--muted);font-size:14px}
    .stat .v{font-weight:800;font-size:22px;margin-top:6px}

    .btn{padding:10px 14px;border-radius:10px;border:1px solid var(--line);background:#fff;font-weight:700;cursor:pointer}
    .btn.primary{background:#3b82f6;color:#fff;border-color:#3b82f6}

    .ads{margin:16px 0}
    .ads-vertical{position:absolute;right:-180px;top:160px;width:160px;display:block}
    @media(max-width:1300px){.ads-vertical{display:none}}
  </style>
</head>
<body>

<!-- Header -->
<div id="header-slot"></div>

<main class="wrap">

  <div class="chips">
    <span class="chip is-on">SIP</span>
    <span class="chip" id="chipSummary">Total Value: £0.00</span>
    <span class="chip" id="chipInvested">Invested: £0.00</span>
    <span class="chip" id="chipGain">Gain: £0.00</span>

    <span style="flex:1"></span>
    <a class="chip" href="/tools/">All tools</a>
  </div>

  <!-- TOP AD (horizontal) -->
  <div class="ads">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-9718922267093672"
         data-ad-slot="3997839388"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
  </div>

  <h1>SIP Calculator</h1>
  <p class="lead">Project your SIP growth with monthly compounding. Supports annual step-up in contributions and a clear growth chart.</p>

  <!-- Vertical AD (desktop) -->
  <div class="ads-vertical">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-9718922267093672"
         data-ad-slot="1830841042"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
  </div>

  <div class="grid">
    <!-- Inputs -->
    <section class="card">
      <div class="hd">Inputs</div>
      <div class="bd">

        <div class="two">
          <div>
            <span class="lab">Monthly Investment (£)</span>
            <input id="inAmt" type="number" min="0" step="10" value="500" />
          </div>
          <div>
            <span class="lab">Expected Return (% p.a.)</span>
            <input id="inRate" type="number" min="0" step="0.1" value="10" />
          </div>
        </div>

        <div class="two">
          <div>
            <span class="lab">Investment Duration (years)</span>
            <input id="inYears" type="number" min="1" step="1" value="15" />
          </div>
          <div>
            <span class="lab">Annual Step-up in SIP (%)</span>
            <input id="inStep" type="number" min="0" step="0.5" value="5" />
          </div>
        </div>

        <div class="two">
          <div>
            <span class="lab">Contribution Day of Month</span>
            <select id="inDom">
              <option value="1">1st</option>
              <option value="5">5th</option>
              <option value="10">10th</option>
              <option value="15" selected>15th</option>
              <option value="20">20th</option>
              <option value="25">25th</option>
            </select>
          </div>
          <div style="display:flex;align-items:end">
            <button id="btnCalc" type="button" class="btn primary" style="width:100%">Calculate</button>
          </div>
        </div>

        <!-- MID AD (horizontal) -->
        <div class="ads">
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-9718922267093672"
               data-ad-slot="3997839388"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
        </div>
      </div>
    </section>

    <!-- Results / Chart -->
    <section class="card">
      <div class="hd">Results</div>
      <div class="bd">
        <div class="stat-grid">
          <div class="stat"><div class="k">Total Value</div><div class="v" id="rValue">£0.00</div></div>
          <div class="stat"><div class="k">Total Invested</div><div class="v" id="rInvested">£0.00</div></div>
          <div class="stat"><div class="k">Total Gain</div><div class="v" id="rGain">£0.00</div></div>
        </div>

        <div style="margin-top:14px;height:340px">
          <canvas id="sipChart"></canvas>
        </div>

        <!-- BOTTOM AD (horizontal) -->
        <div class="ads">
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-9718922267093672"
               data-ad-slot="3997839388"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
        </div>

      </div>
    </section>
  </div>
</main>

<!-- Footer -->
<div id="footer-slot"></div>

<script>
  // Load partials (absolute paths for Azure)
  async function loadPartial(id, url){
    try{
      const r = await fetch(url, {cache:'no-store'});
      if(r.ok) document.getElementById(id).innerHTML = await r.text();
    }catch(e){ console.warn('Partial load failed:', url, e); }
  }
  loadPartial('header-slot','/partials/header.html');
  loadPartial('footer-slot','/partials/footer.html');

  // ===== SIP logic (inline, no external file) =====
  (function(){
    const $  = s => document.querySelector(s);
    const £  = n => (n||0).toLocaleString('en-GB',{style:'currency',currency:'GBP',maximumFractionDigits:2});

    const els = {
      amt:    $('#inAmt'),
      rate:   $('#inRate'),
      years:  $('#inYears'),
      step:   $('#inStep'),
      dom:    $('#inDom'),
      value:  $('#rValue'),
      inv:    $('#rInvested'),
      gain:   $('#rGain'),
      chipSum:$('#chipSummary'),
      chipInv:$('#chipInvested'),
      chipG:  $('#chipGain'),
      btn:    $('#btnCalc'),
      canvas: $('#sipChart')
    };

    let chart = null;

    function computeSIP({monthly, annualRatePct, years, stepPct}){
      const months = Math.max(1, Math.floor((+years||0)*12));
      const r = ((+annualRatePct||0)/100) / 12;
      const step = Math.max(0, (+stepPct||0)/100);

      let invested = 0;
      let value = 0;
      let contrib = +monthly || 0;

      const points = [];
      for(let m=1; m<=months; m++){
        value = value * (1 + r) + contrib;
        invested += contrib;
        points.push({ month:m, investedSoFar:invested, valueSoFar:value });
        if(m % 12 === 0 && step > 0){ contrib = contrib * (1 + step); }
      }
      return { totalInvested: invested, totalValue: value, points };
    }

    function drawChart(points){
      if(!els.canvas || !window.Chart) return;
      const labels = points.map(p => p.month);
      const invested = points.map(p => p.investedSoFar);
      const value = points.map(p => p.valueSoFar);

      if(chart) chart.destroy();
      chart = new Chart(els.canvas.getContext('2d'), {
        type: 'line',
        data: {
          labels,
          datasets: [
            { label: 'Invested', data: invested, tension: 0.25 },
            { label: 'Value', data: value, tension: 0.25 }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { position: 'bottom' },
            tooltip: { callbacks: { label: (ctx) => `${ctx.dataset.label}: ${£(ctx.parsed.y)}` } }
          },
          scales: {
            y: { ticks: { callback: v => £(v) } },
            x: { ticks: { maxRotation: 0, autoSkip: true, maxTicksLimit: 12 } }
          }
        }
      });
    }

    function calc(){
      const monthly = +els.amt.value || 0;
      const rate    = +els.rate.value || 0;
      const years   = +els.years.value || 0;
      const step    = +els.step.value || 0;

      const res = computeSIP({ monthly, annualRatePct: rate, years, stepPct: step });

      const invested = res.totalInvested;
      const value    = res.totalValue;
      const gain     = Math.max(0, value - invested);

      els.inv.textContent   = £(invested);
      els.value.textContent = £(value);
      els.gain.textContent  = £(gain);

      els.chipInv.textContent = `Invested: ${£(invested)}`;
      els.chipSum.textContent = `Total Value: ${£(value)}`;
      els.chipG.textContent   = `Gain: ${£(gain)}`;

      drawChart(res.points);
    }

    // Wire events
    ['input','change'].forEach(evt=>{
      els.amt.addEventListener(evt, calc);
      els.rate.addEventListener(evt, calc);
      els.years.addEventListener(evt, calc);
      els.step.addEventListener(evt, calc);
      els.dom.addEventListener(evt, calc);
    });
    els.btn.addEventListener('click', calc);

    // First render
    calc();
  })();
</script>
</body>
</html>
